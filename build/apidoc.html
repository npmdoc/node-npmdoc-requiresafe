<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/requiresafe/cli#readme"

    >requiresafe (v2.3.1)</a>
</h1>
<h4>the requiresafe.com command line interface tool</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe">module requiresafe</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.check">
            function <span class="apidocSignatureSpan">requiresafe.</span>check
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>formatters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>root</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.config">module requiresafe.config</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.config.update">
            function <span class="apidocSignatureSpan">requiresafe.config.</span>update
            <span class="apidocSignatureSpan">(settings, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.formatters">module requiresafe.formatters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.codeclimate">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>codeclimate
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.default">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>default
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.json">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>json
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.none">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>none
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.summary">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>summary
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.root">module requiresafe.root</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.root.command">
            function <span class="apidocSignatureSpan">requiresafe.root.</span>command
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.root.</span>options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">requiresafe.root.</span>name</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe" id="apidoc.module.requiresafe">module requiresafe</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.check" id="apidoc.element.requiresafe.check">
        function <span class="apidocSignatureSpan">requiresafe.</span>check
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">check = function (options, callback) {

  if (typeof options === &#x27;function&#x27;) {
    callback = options;
    options = {};
  }

  options.proxy = options.proxy || Conf.proxy;
  if (options.proxy) {
    Conf.api.agent = new ProxyAgent(options.proxy);
    delete options.proxy;
  }

  // Set defaults
  var wreck = Wreck.defaults(Conf.api);

  var shrinkwrap;
  var offline = options.offline;
  delete options.offline;

  var advisoriesPath = options.advisoriesPath;
  delete options.advisoriesPath;

  if (!options.exceptions) {
    options.exceptions = Conf.exceptions;
  }

  // validate if options are correct
  var isValid = Joi.validate(options, internals.optionSchema);

  if (isValid.error) {
    return callback(isValid.error);
  }

  options = isValid.value;

  if (typeof options.package === &#x27;string&#x27;) {
    try {
      options.package = require(options.package);
    } catch (e) {
      return callback(e);
    }
  }

  if (typeof options.shrinkwrap === &#x27;string&#x27;) {
    try {
      shrinkwrap = options.shrinkwrap;
      options.shrinkwrap = require(options.shrinkwrap);
    } catch (e) {
      delete options.shrinkwrap;
    }
  }

  if (offline) {
    var advisories;

    if (!options.shrinkwrap) {
      return callback(new Error(&#x27;npm-shrinkwrap.json is required for offline mode&#x27;));
    }
    try {
      if (advisoriesPath) {
        advisories = require(advisoriesPath);
      }
      else {
        advisories = require(&#x27;../advisories&#x27;);
      }
    } catch (e) {
      return callback(new Error(&#x27;Offline mode requires a local advisories.json&#x27;));
    }

    shrinkwrap = Fs.readFileSync(shrinkwrap, &#x27;utf8&#x27;);
    advisories = advisories.results;
    var exceptions = options.exceptions.map(function (exception) {

      return Number(internals.exceptionRegex.exec(exception)[1]);
    });

    var generateContent = function (advisory) {

      var markdown = [
        &#x27;# &#x27; + advisory.title,
        &#x27;## Overview:&#x27;,
        advisory.overview
      ];

      if (advisory.recommendation) {
        markdown.push(&#x27;&#x27;);
        markdown.push(&#x27;## Recommendation:&#x27;);
        markdown.push(advisory.recommendation);
      }

      if (advisory.references) {
        markdown.push(&#x27;&#x27;);
        markdown.push(&#x27;## References:&#x27;);
        markdown.push(advisory.references);
      }

      return markdown.join(&#x27;\n&#x27;);
    };

    NPMUtils.getShrinkwrapDependencies(options.shrinkwrap, function (err, tree) {

      var keys = Object.keys(tree);
      var vulns = keys.map(function (key) {

        var mod = tree[key];
        var matches = [];
        for (var i = 0, il = advisories.length; i &#x3c; il; ++i) {
          if (mod.name === advisories[i].module_name &#x26;&#x26;
              exceptions.indexOf(advisories[i].id) === -1 &#x26;&#x26;
              Semver.satisfies(mod.version, advisories[i].vulnerable_versions)) {

            matches.push(advisories[i]);
          }
        }

        return {
          module: mod.name,
          version: mod.version,
          vulnerabilities: matches
        };
      }).filter(function (mod) {

        return mod.vulnerabilities.length &#x3e; 0;
      });

      var results = [];
      for (var i = 0, il = vulns.length; i &#x3c; il; ++i) {
        var path = tree[vulns[i].module + &#x27;@&#x27; + vulns[i].version].parents;
        var line = internals.findLines(shrinkwrap, vulns[i].module, vulns[i].version);
        for (var x = 0, xl = vulns[i].vulnerabilities.length; x &#x3c; xl; ++x) {
          results.push({
            module: vulns[i].module,
            version: vulns[i].version,
            vulnerable_versions: vulns[i].vulnerabilities[x].vulnerable_versions,
            patched_versions: vulns[i].vulnerabilities[x].patched_versions,
            title: vulns[i].vulnerabilities[x].title,
            path: path,
            advisory: &#x27;https://requiresafe.com/advisories/&#x27; + vulns[i].vulnerabilities[x].id,
            line: line,
            content: generateContent(vulns[i].vulnerabilities[x])
          });
        }
      }

      return callback(null, results);
    });
  }
  else {
    if (!options.package) {
      return callback(new Error(&#x27;package.json is requi ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.config" id="apidoc.module.requiresafe.config">module requiresafe.config</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.config.update" id="apidoc.element.requiresafe.config.update">
        function <span class="apidocSignatureSpan">requiresafe.config.</span>update
        <span class="apidocSignatureSpan">(settings, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (settings, callback) {

  var home = process.platform === &#x27;win32&#x27; ? process.env.USERPROFILE : process.env.HOME;
  var configPath = Path.join(home, &#x27;.requiresaferc&#x27;);
  var current = {};
  try {
    current = JSON.parse(Fs.readFileSync(configPath));
  }
  catch (err) {}

  for (var setting in settings) {
    if (settings[setting] === &#x27;&#x27;) {
      delete current[setting];
    }
    else {
      current[setting] = settings[setting];
    }
  }

  // if it&#x27;s empty delete the config file entirely to clean up
  // after ourselves.
  if (Object.keys(current).length === 0) {
    try {
      Fs.unlinkSync(configPath);
    }
    catch (err) {}

    return callback(null);
  }

  // try to write it back

  Fs.writeFile(configPath, JSON.stringify(current, null, 2), &#x27;utf8&#x27;, function (err) {

    if (err) {
      return callback(err);
    }
    return callback();

  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.formatters" id="apidoc.module.requiresafe.formatters">module requiresafe.formatters</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.formatters.codeclimate" id="apidoc.element.requiresafe.formatters.codeclimate">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>codeclimate
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">codeclimate = function (err, data) {

  if (err) {
    return &#x27;Debug output: %j&#x27; + data + &#x27;\n&#x27; + JSON.stringify(err);
  }

  if (!data.length) {
    return;
  }

  var returnString = &#x27;&#x27;;
  for (var i = 0, il = data.length; i &#x3c; il; ++i) {
    returnString += JSON.stringify({
      type: &#x27;issue&#x27;,
      check_name: &#x27;Vulnerable module &#x22;&#x27; + data[i].module + &#x27;&#x22; identified&#x27;,
      description: &#x27;`&#x27; + data[i].module + &#x27;` &#x27; + data[i].title,
      categories: [&#x27;Security&#x27;],
      content: {
        body: data[i].content
      },
      location: {
        path: &#x27;npm-shrinkwrap.json&#x27;,
        lines: {
          begin: data[i].line.start,
          end: data[i].line.end
        }
      }
    }) + &#x27;\0\n&#x27;;
  }

  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.default" id="apidoc.element.requiresafe.formatters.default">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>default
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function (err, data) {

  var returnString = &#x27;&#x27;;

  if (err) {
    if (data) {
      returnString += Chalk.red(&#x27;(+) &#x27;) + &#x27;Debug output: &#x27; + data + &#x27;\n&#x27;;
    }

    return returnString + Chalk.yellow(&#x27;(+) &#x27;) + err;
  }

  var width = 80;
  if (process.stdout.isTTY) {
    width = process.stdout.getWindowSize()[0] - 10;
  }
  if (data.length === 0) {

    return Chalk.green(&#x27;(+)&#x27;) + &#x27; No known vulnerabilities found&#x27;;
  }

  returnString += Chalk.red(&#x27;(+) &#x27;) + data.length + &#x27; vulnerabilities found\n&#x27;;

  data.forEach(function (finding) {

    var table = new Table({
      head: [&#x27;&#x27;, finding.title],
      colWidths: [15, width - 15]
    });

    table.push([&#x27;Name&#x27;, finding.module]);
    table.push([&#x27;Installed&#x27;, finding.version]);
    table.push([&#x27;Vulnerable&#x27;, finding.vulnerable_versions === &#x27;&#x3c;=99.999.99999&#x27; ? &#x27;All&#x27; : finding.vulnerable_versions]);
    table.push([&#x27;Patched&#x27;, finding.patched_versions === &#x27;&#x3c;0.0.0&#x27; ? &#x27;None&#x27; : finding.patched_versions]);
    table.push([&#x27;Path&#x27;, finding.path.join(&#x27; &#x3e; &#x27;)]);
    table.push([&#x27;More Info&#x27;, finding.advisory]);

    returnString += table.toString() + &#x27;\n&#x27;;
  });

  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

internals.exceptionRegex = /^https\:\/\/requiresafe\.com\/advisories\/([0-9]+)$/;

internals.optionSchema = Joi.object({
package: Joi.alternatives().try(Joi.string(), Joi.object()),
shrinkwrap: Joi.alternatives().try(Joi.string(), Joi.object()),
exceptions: Joi.array().items(Joi.string().regex(internals.exceptionRegex)).<span class="apidocCodeKeywordSpan">default</span>([]),
advisoriesPath: Joi.string(),
proxy: Joi.string()
}).or([&#x27;package&#x27;, &#x27;shrinkwrap&#x27;]);

/*
options should be an object that contains one or more of the keys package, shrinkwrap, offline
{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.json" id="apidoc.element.requiresafe.formatters.json">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>json
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function (err, data) {

  if (err) {
    return &#x27;Debug output: &#x27; + data + &#x27;\n&#x27; + JSON.stringify(err);
  }

  return JSON.stringify(data, null, 2);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.none" id="apidoc.element.requiresafe.formatters.none">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>none
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">none = function (err, data) {

  return {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.summary" id="apidoc.element.requiresafe.formatters.summary">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>summary
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">summary = function (err, data) {

  var returnString = &#x27;&#x27;;

  if (err) {
    if (data) {
      returnString += Chalk.red(&#x27;(+) &#x27;) + &#x27;Debug output: &#x27; + data + &#x27;\n&#x27;;
    }

    return returnString + Chalk.yellow(&#x27;(+) &#x27;) + err;
  }

  if (data.length === 0) {

    return Chalk.green(&#x27;(+)&#x27;) + &#x27; No known vulnerabilities found&#x27;;
  }

  returnString += Chalk.red(&#x27;(+) &#x27;) + data.length + &#x27; vulnerabilities found\n&#x27;;

  var table = new Table({
    head: [&#x27;Name&#x27;, &#x27;Installed&#x27;, &#x27;Patched&#x27;, &#x27;Path&#x27;, &#x27;More Info&#x27;],
    chars: {
      top: &#x27;&#x27;,
      &#x27;top-mid&#x27;: &#x27;&#x27;,
      &#x27;top-left&#x27;: &#x27;&#x27;,
      &#x27;top-right&#x27;: &#x27;&#x27;,
      &#x27;bottom&#x27;: &#x27;&#x27;,
      &#x27;bottom-mid&#x27;: &#x27;&#x27;,
      &#x27;bottom-left&#x27;: &#x27;&#x27;,
      &#x27;bottom-right&#x27;: &#x27;&#x27;,
      left: &#x27;&#x27;,
      &#x27;left-mid&#x27;: &#x27;&#x27;,
      &#x27;mid&#x27;: &#x27;&#x27;,
      &#x27;mid-mid&#x27;: &#x27;&#x27;,
      right: &#x27;&#x27;,
      &#x27;right-mid&#x27;: &#x27;&#x27;,
      middle: &#x27; &#x27;
    }
  });

  data.forEach(function (finding) {

    table.push([finding.module, finding.version, finding.patched_versions === &#x27;&#x3c;0.0.0&#x27; ? &#x27;None&#x27; : finding.patched_versions, finding
.path.join(&#x27; &#x3e; &#x27;), finding.advisory]);
  });

  returnString += table.toString() + &#x27;\n&#x27;;
  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.root" id="apidoc.module.requiresafe.root">module requiresafe.root</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.root.command" id="apidoc.element.requiresafe.root.command">
        function <span class="apidocSignatureSpan">requiresafe.root.</span>command
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">command = function (args) {

  if (args.version) {
    return console.log(require(&#x27;../../package.json&#x27;).version);
  }
  return usage();

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
