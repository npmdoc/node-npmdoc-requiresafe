<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/requiresafe/cli#readme">requiresafe (v2.3.1)</a>
</h1>
<h4>the requiresafe.com command line interface tool</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe">module requiresafe</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.check">
            function <span class="apidocSignatureSpan">requiresafe.</span>check
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>formatters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.</span>root</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.config">module requiresafe.config</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.config.update">
            function <span class="apidocSignatureSpan">requiresafe.config.</span>update
            <span class="apidocSignatureSpan">(settings, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.formatters">module requiresafe.formatters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.codeclimate">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>codeclimate
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.default">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>default
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.json">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>json
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.none">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>none
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.formatters.summary">
            function <span class="apidocSignatureSpan">requiresafe.formatters.</span>summary
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.requiresafe.root">module requiresafe.root</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.requiresafe.root.command">
            function <span class="apidocSignatureSpan">requiresafe.root.</span>command
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">requiresafe.root.</span>options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">requiresafe.root.</span>name</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe" id="apidoc.module.requiresafe">module requiresafe</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.check" id="apidoc.element.requiresafe.check">
        function <span class="apidocSignatureSpan">requiresafe.</span>check
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">check = function (options, callback) {

  if (typeof options === 'function') {
    callback = options;
    options = {};
  }

  options.proxy = options.proxy || Conf.proxy;
  if (options.proxy) {
    Conf.api.agent = new ProxyAgent(options.proxy);
    delete options.proxy;
  }

  // Set defaults
  var wreck = Wreck.defaults(Conf.api);

  var shrinkwrap;
  var offline = options.offline;
  delete options.offline;

  var advisoriesPath = options.advisoriesPath;
  delete options.advisoriesPath;

  if (!options.exceptions) {
    options.exceptions = Conf.exceptions;
  }

  // validate if options are correct
  var isValid = Joi.validate(options, internals.optionSchema);

  if (isValid.error) {
    return callback(isValid.error);
  }

  options = isValid.value;

  if (typeof options.package === 'string') {
    try {
      options.package = require(options.package);
    } catch (e) {
      return callback(e);
    }
  }

  if (typeof options.shrinkwrap === 'string') {
    try {
      shrinkwrap = options.shrinkwrap;
      options.shrinkwrap = require(options.shrinkwrap);
    } catch (e) {
      delete options.shrinkwrap;
    }
  }

  if (offline) {
    var advisories;

    if (!options.shrinkwrap) {
      return callback(new Error('npm-shrinkwrap.json is required for offline mode'));
    }
    try {
      if (advisoriesPath) {
        advisories = require(advisoriesPath);
      }
      else {
        advisories = require('../advisories');
      }
    } catch (e) {
      return callback(new Error('Offline mode requires a local advisories.json'));
    }

    shrinkwrap = Fs.readFileSync(shrinkwrap, 'utf8');
    advisories = advisories.results;
    var exceptions = options.exceptions.map(function (exception) {

      return Number(internals.exceptionRegex.exec(exception)[1]);
    });

    var generateContent = function (advisory) {

      var markdown = [
        '# ' + advisory.title,
        '## Overview:',
        advisory.overview
      ];

      if (advisory.recommendation) {
        markdown.push('');
        markdown.push('## Recommendation:');
        markdown.push(advisory.recommendation);
      }

      if (advisory.references) {
        markdown.push('');
        markdown.push('## References:');
        markdown.push(advisory.references);
      }

      return markdown.join('\n');
    };

    NPMUtils.getShrinkwrapDependencies(options.shrinkwrap, function (err, tree) {

      var keys = Object.keys(tree);
      var vulns = keys.map(function (key) {

        var mod = tree[key];
        var matches = [];
        for (var i = 0, il = advisories.length; i &lt; il; ++i) {
          if (mod.name === advisories[i].module_name &amp;&amp;
              exceptions.indexOf(advisories[i].id) === -1 &amp;&amp;
              Semver.satisfies(mod.version, advisories[i].vulnerable_versions)) {

            matches.push(advisories[i]);
          }
        }

        return {
          module: mod.name,
          version: mod.version,
          vulnerabilities: matches
        };
      }).filter(function (mod) {

        return mod.vulnerabilities.length &gt; 0;
      });

      var results = [];
      for (var i = 0, il = vulns.length; i &lt; il; ++i) {
        var path = tree[vulns[i].module + '@' + vulns[i].version].parents;
        var line = internals.findLines(shrinkwrap, vulns[i].module, vulns[i].version);
        for (var x = 0, xl = vulns[i].vulnerabilities.length; x &lt; xl; ++x) {
          results.push({
            module: vulns[i].module,
            version: vulns[i].version,
            vulnerable_versions: vulns[i].vulnerabilities[x].vulnerable_versions,
            patched_versions: vulns[i].vulnerabilities[x].patched_versions,
            title: vulns[i].vulnerabilities[x].title,
            path: path,
            advisory: 'https://requiresafe.com/advisories/' + vulns[i].vulnerabilities[x].id,
            line: line,
            content: generateContent(vulns[i].vulnerabilities[x])
          });
        }
      }

      return callback(null, results);
    });
  }
  else {
    if (!options.package) {
      return callback(new Error('package.json is requi ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.config" id="apidoc.module.requiresafe.config">module requiresafe.config</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.config.update" id="apidoc.element.requiresafe.config.update">
        function <span class="apidocSignatureSpan">requiresafe.config.</span>update
        <span class="apidocSignatureSpan">(settings, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (settings, callback) {

  var home = process.platform === 'win32' ? process.env.USERPROFILE : process.env.HOME;
  var configPath = Path.join(home, '.requiresaferc');
  var current = {};
  try {
    current = JSON.parse(Fs.readFileSync(configPath));
  }
  catch (err) {}

  for (var setting in settings) {
    if (settings[setting] === '') {
      delete current[setting];
    }
    else {
      current[setting] = settings[setting];
    }
  }

  // if it's empty delete the config file entirely to clean up
  // after ourselves.
  if (Object.keys(current).length === 0) {
    try {
      Fs.unlinkSync(configPath);
    }
    catch (err) {}

    return callback(null);
  }

  // try to write it back

  Fs.writeFile(configPath, JSON.stringify(current, null, 2), 'utf8', function (err) {

    if (err) {
      return callback(err);
    }
    return callback();

  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.formatters" id="apidoc.module.requiresafe.formatters">module requiresafe.formatters</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.formatters.codeclimate" id="apidoc.element.requiresafe.formatters.codeclimate">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>codeclimate
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">codeclimate = function (err, data) {

  if (err) {
    return 'Debug output: %j' + data + '\n' + JSON.stringify(err);
  }

  if (!data.length) {
    return;
  }

  var returnString = '';
  for (var i = 0, il = data.length; i &lt; il; ++i) {
    returnString += JSON.stringify({
      type: 'issue',
      check_name: 'Vulnerable module "' + data[i].module + '" identified',
      description: '`' + data[i].module + '` ' + data[i].title,
      categories: ['Security'],
      content: {
        body: data[i].content
      },
      location: {
        path: 'npm-shrinkwrap.json',
        lines: {
          begin: data[i].line.start,
          end: data[i].line.end
        }
      }
    }) + '\0\n';
  }

  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.default" id="apidoc.element.requiresafe.formatters.default">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>default
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function (err, data) {

  var returnString = '';

  if (err) {
    if (data) {
      returnString += Chalk.red('(+) ') + 'Debug output: ' + data + '\n';
    }

    return returnString + Chalk.yellow('(+) ') + err;
  }

  var width = 80;
  if (process.stdout.isTTY) {
    width = process.stdout.getWindowSize()[0] - 10;
  }
  if (data.length === 0) {

    return Chalk.green('(+)') + ' No known vulnerabilities found';
  }

  returnString += Chalk.red('(+) ') + data.length + ' vulnerabilities found\n';

  data.forEach(function (finding) {

    var table = new Table({
      head: ['', finding.title],
      colWidths: [15, width - 15]
    });

    table.push(['Name', finding.module]);
    table.push(['Installed', finding.version]);
    table.push(['Vulnerable', finding.vulnerable_versions === '&lt;=99.999.99999' ? 'All' : finding.vulnerable_versions]);
    table.push(['Patched', finding.patched_versions === '&lt;0.0.0' ? 'None' : finding.patched_versions]);
    table.push(['Path', finding.path.join(' &gt; ')]);
    table.push(['More Info', finding.advisory]);

    returnString += table.toString() + '\n';
  });

  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

internals.exceptionRegex = /^https\:\/\/requiresafe\.com\/advisories\/([0-9]+)$/;

internals.optionSchema = Joi.object({
package: Joi.alternatives().try(Joi.string(), Joi.object()),
shrinkwrap: Joi.alternatives().try(Joi.string(), Joi.object()),
exceptions: Joi.array().items(Joi.string().regex(internals.exceptionRegex)).<span class="apidocCodeKeywordSpan">default</span>([]),
advisoriesPath: Joi.string(),
proxy: Joi.string()
}).or(['package', 'shrinkwrap']);

/*
options should be an object that contains one or more of the keys package, shrinkwrap, offline
{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.json" id="apidoc.element.requiresafe.formatters.json">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>json
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function (err, data) {

  if (err) {
    return 'Debug output: ' + data + '\n' + JSON.stringify(err);
  }

  return JSON.stringify(data, null, 2);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.none" id="apidoc.element.requiresafe.formatters.none">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>none
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">none = function (err, data) {

  return {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.requiresafe.formatters.summary" id="apidoc.element.requiresafe.formatters.summary">
        function <span class="apidocSignatureSpan">requiresafe.formatters.</span>summary
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">summary = function (err, data) {

  var returnString = '';

  if (err) {
    if (data) {
      returnString += Chalk.red('(+) ') + 'Debug output: ' + data + '\n';
    }

    return returnString + Chalk.yellow('(+) ') + err;
  }

  if (data.length === 0) {

    return Chalk.green('(+)') + ' No known vulnerabilities found';
  }

  returnString += Chalk.red('(+) ') + data.length + ' vulnerabilities found\n';

  var table = new Table({
    head: ['Name', 'Installed', 'Patched', 'Path', 'More Info'],
    chars: {
      top: '',
      'top-mid': '',
      'top-left': '',
      'top-right': '',
      'bottom': '',
      'bottom-mid': '',
      'bottom-left': '',
      'bottom-right': '',
      left: '',
      'left-mid': '',
      'mid': '',
      'mid-mid': '',
      right: '',
      'right-mid': '',
      middle: ' '
    }
  });

  data.forEach(function (finding) {

    table.push([finding.module, finding.version, finding.patched_versions === '&lt;0.0.0' ? 'None' : finding.patched_versions, finding
.path.join(' &gt; '), finding.advisory]);
  });

  returnString += table.toString() + '\n';
  return returnString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.requiresafe.root" id="apidoc.module.requiresafe.root">module requiresafe.root</a></h1>


    <h2>
        <a href="#apidoc.element.requiresafe.root.command" id="apidoc.element.requiresafe.root.command">
        function <span class="apidocSignatureSpan">requiresafe.root.</span>command
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">command = function (args) {

  if (args.version) {
    return console.log(require('../../package.json').version);
  }
  return usage();

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>